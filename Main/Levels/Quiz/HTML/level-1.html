<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MindCraft HTML Lesson 1 Quiz</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    /* YOUR EXACT DESIGN - NO CHANGES */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-size:10px;overflow:hidden;}
    
    body{
      font-family:'Press Start 2P', cursive;
      background:linear-gradient(#87e4ff,#c8f7b0);
      padding:20px;
      margin:0;
    }

    .quiz-container{
      max-width:1000px;
      margin:0 auto;
      height:calc(100vh - 40px);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }

    .wood-border{
      width:100%;
      max-width:900px;
      height:90vh;
      position:relative;
      background:#8b5a2b;
      border-radius:28px;
      padding:16px;
      box-shadow:
        inset -8px -8px 0 rgba(0,0,0,.3),
        0 12px 0 #5c3a1a;
    }

    .wood-border::before{
      content:'MINDCRAFT HTML QUIZ';
      position:absolute;
      top:-14px;
      left:50%;
      transform:translateX(-50%);
      background:#8b5a2b;
      padding:6px 20px;
      font-size:11px;
      color:#ffd966;
      text-shadow:2px 2px #000;
      border-radius:10px;
      box-shadow:0 4px 0 #5c3a1a;
    }

    .wood-brand{display:none;}

    .quiz-content{
      height:100%;
      width:100%;
      background:linear-gradient(#8fe9ff 55%, #7dd37d);
      border-radius:16px;
      padding:24px;
      box-shadow:0 20px 50px rgba(0,0,0,.3);
      display:flex;
      flex-direction:column;
      position:relative;
      z-index:2;
    }

    .main-title{
      text-align:center;
      font-size:16px;
      text-shadow:3px 3px #fff;
      margin-bottom:20px;
      color:#006400;
    }

    .quiz-panel{
      flex:1;
      display:flex;
      flex-direction:column;
      justify-content:center;
      padding:16px;
      overflow:auto;
    }

    .top-bar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:20px;
      font-size:9px;
    }

    .progress{ color:#006400; font-weight:bold; }
    .timer{ color:#b8860b; font-weight:bold; }

    .question-box{
      background:#fff3cd;
      border:3px solid #c9a227;
      padding:20px;
      border-radius:12px;
      margin-bottom:24px;
      line-height:1.6;
      box-shadow:0 6px 0 #c9a227;
      max-height:300px;
    }

    .question-text{
      font-size:11px;
      margin-bottom:16px;
      font-weight:bold;
    }

    .options label{
      display:block;
      margin:10px 0;
      cursor:pointer;
      font-size:9px;
    }

    .options input{
      margin-right:10px;
      transform:scale(1.3);
      accent-color:#006400;
    }

    .fill-input{
      width:100%;
      max-width:380px;
      padding:12px;
      border:3px solid #c9a227;
      background:#fff;
      border-radius:10px;
      font-family:'Press Start 2P', cursive;
      font-size:9px;
      color:#000;
      box-shadow:0 4px 0 #c9a227;
    }

    .nav-row{
      display:flex;
      justify-content:center;
      gap:16px;
      margin-top:20px;
    }

    button{
      font-family:'Press Start 2P', cursive;
      background:#a56b34;
      color:#fff;
      border:none;
      padding:12px 20px;
      border-radius:12px;
      box-shadow:
        inset -4px -4px 0 rgba(0,0,0,.25),
        0 6px 0 #5c3a1a;
      cursor:pointer;
      font-size:8px;
      transition:transform 0.1s;
      min-width:120px;
    }

    button:hover:not(:disabled){
      transform:translateY(-2px);
    }

    button:disabled{
      opacity:0.5;
      cursor:not-allowed;
      transform:none;
      box-shadow: inset -4px -4px 0 rgba(0,0,0,.25), 0 2px 0 #5c3a1a;
    }

    #nextBtn{ background:#a56b34; }
    #finishBtn{ 
      background:#d4af37; 
      box-shadow:
        inset -4px -4px 0 rgba(0,0,0,.25),
        0 6px 0 #b8860b;
      display:none;
    }

    #backBtn{
      background:#ff6b35;
      box-shadow:
        inset -4px -4px 0 rgba(0,0,0,.25),
        0 6px 0 #cc5533;
      display:none;
    }

    #resultBox{
      margin-top:24px;
      padding:20px;
      border-radius:12px;
      font-size:10px;
      text-align:center;
      display:none;
      box-shadow:0 6px 0 #6aa84f;
    }

    .result-success{
      background:#d9ead3 !important;
      border:4px solid #6aa84f !important;
      color:#006400 !important;
      display:block !important;
    }

    @media(max-width:768px){
      .quiz-container{
        height:auto;
        min-height:calc(100vh - 40px);
        align-items:flex-start;
        padding-top:20px;
      }
      body{ overflow:auto; padding:10px; }
      .wood-border{
        height:auto;
        min-height:80vh;
        border-radius:20px;
        padding:12px;
      }
      .quiz-content{ padding:18px; border-radius:12px; }
      .main-title{ font-size:14px; }
    }
  </style>
</head>
<body>
<div class="quiz-container">
  <div class="wood-border">
    <div class="wood-brand">
      MindCraft<br>
      <span style="font-size:6px;">HTML Lesson 1 ‚Ä¢ Basics Quiz</span>
    </div>

    <div class="quiz-content">
      <div class="main-title">
        LESSON 1<br>
        <span style="font-size:12px; font-weight:normal;">HTML STRUCTURE & ELEMENTS QUIZ</span>
      </div>

      <div class="quiz-panel">
        <div class="top-bar">
          <div class="progress" id="progress">Question 1 / 10</div>
          <div class="timer" id="timer">10:00</div>
        </div>

        <div id="questionContainer" class="question-box"></div>

        <div class="nav-row">
          <button id="nextBtn">NEXT ‚Üí</button>
          <button id="finishBtn">FINISH & SCORE</button>
          <button id="backBtn">‚Üê BACK</button>
        </div>

        <div id="resultBox">Complete all questions for your score!</div>
      </div>
    </div>
  </div>
</div>

  <script type="module" src="../../../Tools/XP/HtmlXP-tools.js"></script>

<script>
  // ‚úÖ FIXED QUESTIONS 8,9,10 + ALL WORKING FEATURES
  const TOTAL_TIME_SECONDS = 10 * 60; // 10 minutes

  const questions = [
    { type:"mc", text:"1. Which tag wraps all HTML content?", options:["<html>","<head>","<body>","<title>"], correct:0 },
    { type:"mc", text:"2. Which element contains metadata like title and CSS links?", options:["<html>","<head>","<body>","<p>"], correct:1 },
    { type:"mc", text:"3. Which of the following is a valid HTML comment?", options:["// comment","<!-- comment -->","/* comment */","* comment *"], correct:1 },
    { type:"mc", text:"4. Where does the visible content of a webpage go?", options:["<html>","<head>","<body>","<meta>"], correct:2 },
    { type:"fill", text:"5. HTML elements are defined using <_______> and </_______> tags.", correctText:"tag" },
    { type:"fill", text:"6. The proper placement of one HTML element inside another is called _______.", correctText:"nesting" },
    { type:"fill", text:"7. Comments in HTML are written using _______.", correctText:"<!--" },
    // ‚úÖ FIXED UNIQUE QUESTIONS 8,9,10
    { type:"fill", text:"8. The <html> tag is called the ______ element of the document.", correctText:"root" },
    { type:"fill", text:"9. The <head> tag contains ______ information like titles and links.", correctText:"metadata" },
    { type:"fill", text:"10. The <body> tag contains the ______ content users see.", correctText:"visible" }
  ];

  let currentIndex = 0;
  let userAnswers = new Array(questions.length).fill(null);
  let remainingSeconds = TOTAL_TIME_SECONDS;
  let quizCompleted = false;
  let timerInterval = null;

  const questionContainer = document.getElementById("questionContainer");
  const progress = document.getElementById("progress");
  const timerDisplay = document.getElementById("timer");
  const nextBtn = document.getElementById("nextBtn");
  const finishBtn = document.getElementById("finishBtn");
  const backBtn = document.getElementById("backBtn");
  const resultBox = document.getElementById("resultBox");

  function formatTime(secs) {
    const m = Math.floor(secs / 60);
    const s = secs % 60;
    return `${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
  }

  function updateTimerDisplay() {
    timerDisplay.textContent = formatTime(remainingSeconds);
  }

  function startTimer() {
    if (timerInterval !== null || quizCompleted) return;
    updateTimerDisplay();
    timerInterval = setInterval(() => {
      remainingSeconds = Math.max(0, remainingSeconds - 1);
      updateTimerDisplay();
      if (remainingSeconds <= 0) {
        clearInterval(timerInterval);
        timerInterval = null;
        if (!quizCompleted) finishQuiz();
      }
    }, 1000);
  }

  function loadQuestion(index) {
    const q = questions[index];
    progress.textContent = `Question ${index + 1} / ${questions.length}`;
    questionContainer.innerHTML = `<div class="question-text">${q.text}</div>`;

    if (q.type === "mc") {
      const optionsDiv = document.createElement("div");
      optionsDiv.className = "options";
      q.options.forEach((opt,i)=>{
        const label=document.createElement("label");
        const radio=document.createElement("input");
        radio.type="radio"; 
        radio.name="mc"; 
        radio.value=i;
        if(userAnswers[index]===i) radio.checked=true;
        label.appendChild(radio);
        label.appendChild(document.createTextNode(" "+opt));
        optionsDiv.appendChild(label);
      });
      questionContainer.appendChild(optionsDiv);
    } else {
      const input=document.createElement("input");
      input.type="text"; 
      input.id="fillInput"; 
      input.className="fill-input"; 
      input.placeholder="Type your answer here...";
      if(userAnswers[index]!==null) input.value=userAnswers[index];
      questionContainer.appendChild(input);
    }
  }

  function updateUI() {
    if (quizCompleted) {
      // AFTER FINISH - Results + BACK button only
      progress.textContent=`Quiz Complete!`;
      timerDisplay.textContent=`00:00`;
      loadQuestion(currentIndex);
      nextBtn.style.display="none";
      finishBtn.style.display="none";
      backBtn.style.display="inline-block";
      resultBox.style.display="block";
      resultBox.className="result-success";
    } else {
      // DURING QUIZ - Back button HIDDEN
      loadQuestion(currentIndex);
      if(currentIndex===questions.length-1){
        nextBtn.style.display="none";
        finishBtn.style.display="inline-block";
      } else {
        nextBtn.style.display="inline-block";
        finishBtn.style.display="none";
      }
      backBtn.style.display="none";
      resultBox.style.display="none";
    }
  }

  function saveCurrentAnswer() {
    if(quizCompleted) return;
    const q=questions[currentIndex];
    if(q.type==="mc"){
      const checked=document.querySelector('input[name="mc"]:checked');
      userAnswers[currentIndex]=checked?parseInt(checked.value):null;
    } else {
      const input=document.getElementById("fillInput");
      userAnswers[currentIndex]=input?input.value.trim():"";
    }
  }

  function calculateScore(){
    let score=0;
    questions.forEach((q,i)=>{
      if(q.type==="mc"){ 
        if(userAnswers[i]===q.correct) score++; 
      }
      else{
        const user=(userAnswers[i]||"").trim().toLowerCase();
        const correct=q.correctText.toLowerCase();
        if(user===correct || user.includes(correct)) score++;
      }
    });
    return score;
  }

  function finishQuiz(){
    if(quizCompleted) return;
    quizCompleted=true;
    currentIndex=questions.length-1;
    saveCurrentAnswer();
    if(timerInterval){ 
      clearInterval(timerInterval); 
      timerInterval=null; 
    }
    const total=questions.length;
    const score=calculateScore();
    const percentage=Math.round((score/total)*100);
    resultBox.innerHTML=`
      <strong>FINAL SCORE: ${score} / ${total}</strong><br>
      <span style="font-size:8px;">${percentage}% - HTML basics mastery logged!</span>
    `;
    updateUI();
    console.log("üß™ HTML Lesson 1 Quiz Complete:",score,"/",total,`(${percentage}%)`);

    // üöÄ Notify XP system that quiz is finished
if (window.handleQuizFinish) {
  try {
    window.handleQuizFinish({ 
      finalScore: score, 
      totalQuestions: total, 
      types: questions.map(q => q.type) 
    });
  } catch (err) {
    console.error("XP system notification failed:", err);
  }
}
  }

  // Event Listeners
  nextBtn.addEventListener("click",()=>{
    if(quizCompleted) return;
    saveCurrentAnswer();
    if(currentIndex<questions.length-1){ 
      currentIndex++; 
      updateUI(); 
    }
  });

  finishBtn.addEventListener("click",()=>finishQuiz());

  backBtn.addEventListener("click",()=>{
    window.location.href="../../../Webside/Student.html";
  });

  // START FRESH - NO LOCALSTORAGE
  updateTimerDisplay();
  updateUI();
  startTimer();
</script>
</body>
</html>


