<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Account - MindCraft</title>
<link rel="stylesheet" href="../Design/Position.css">
<link rel="stylesheet" href="../Design/global_size-FIX.css">
<style>
body {
Â  font-family: 'Poppins', sans-serif;
Â  margin: 0;
Â  padding: 0;
Â  text-align: center;
Â  transition: background 0.3s, color 0.3s;
}
nav {
Â  background: rgba(0,0,0,0.6);
Â  padding: 10px;
Â  display: flex;
Â  justify-content: center;
Â  gap: 15px;
}
nav button {
Â  padding: 8px 16px;
Â  border: none;
Â  border-radius: 8px;
Â  background: #1DB954;
Â  color: white;
Â  cursor: pointer;
Â  transition: all 0.3s ease;
}
nav button:hover { background: #1ed760; }
.container {
Â  margin-top: 50px;
Â  background: rgba(0,0,0,0.4);
Â  padding: 20px;
Â  border-radius: 12px;
Â  max-width: 500px;
Â  margin-left: auto;
Â  margin-right: auto;
Â  box-shadow: 0 0 15px #1DB954;
}
h2 { margin-bottom: 15px; }
</style>
</head>
<body>

<nav>
Â  <button onclick="location.href='../../index.html'">ğŸ  Home</button>
Â  <button onclick="location.href='../Settings/setting.html'">âš™ï¸ Settings</button>
Â  <button onclick="logout()">ğŸšª Logout</button>
</nav>

<div class="container">
Â  <h2>ğŸ‘¤ Account Information</h2>
Â  <p><b>Username:</b> <span id="username">Guest</span></p>
Â  <p><b>Level:</b> <span id="level">1</span></p>
Â  <p><b>XP:</b> <span id="xp">0</span></p>
</div>

<script>
// =============================
// Check login
// =============================
const currentUser = localStorage.getItem('currentUser');

if (!currentUser) {
Â  alert('You must sign in first!');
Â  // Redirect to signin page, which is assumed to be in the same folder.
Â  window.location.href = 'signin.html';
}

// --- UI Elements ---
const usernameEl = document.getElementById('username');
const levelEl = document.getElementById('level');
const xpEl = document.getElementById('xp');

// =============================
// Function to Load and Display User Data
// =============================
function loadUserData() {
    if (!currentUser) return;
    
    // Load current XP, Level, and Max XP from storage
    let xp = parseInt(localStorage.getItem(`${currentUser}_xp`)) || 0;
    let level = parseInt(localStorage.getItem(`${currentUser}_level`)) || 1;
    let xpMax = parseInt(localStorage.getItem(`${currentUser}_xpMax`)) || 100;
    
    // Self-correcting logic (ensures display consistency)
    const XP_CAP_MULTIPLIER = 1.25;
    while (xp >= xpMax) {
        xp -= xpMax;
        level++;
        xpMax = Math.floor(xpMax * XP_CAP_MULTIPLIER);
    }

    // Display the data
    usernameEl.textContent = currentUser;
    levelEl.textContent = level;
    xpEl.textContent = `${xp}/${xpMax}`;
}

// Load data on initial page load
loadUserData();


// =============================
// Listen for XP/Level changes in other tabs (Dynamic Update)
// ===================================
window.addEventListener('storage', (e) => {
    // Only refresh if the XP or Level data for the current user has changed
    if (e.key && e.key.startsWith(`${currentUser}_`)) {
        loadUserData();
    }
});


// =============================
// Logout function
// =============================
function logout() {
Â  localStorage.setItem('lastUser', currentUser); // optional tracking
Â  localStorage.removeItem('currentUser');
Â  // Assuming signin.html is in the same folder as account.html (../Account/)
Â  window.location.href = 'signin.html'; 
}
</script>

<script src="../Design/theme.js"></script>
</body>
</html>
